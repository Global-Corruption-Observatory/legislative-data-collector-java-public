package com.precognox.ceu.legislative_data_collector.sweden;

import com.precognox.ceu.legislative_data_collector.entities.PageSource;
import org.jsoup.Jsoup;
import org.junit.jupiter.api.Test;

import java.io.IOException;
import java.util.Set;

import static com.precognox.ceu.legislative_data_collector.common.ResourceLoader.getPageSourceObj;
import static org.junit.jupiter.api.Assertions.assertEquals;

class AffectingLawsParserTest {

    private AffectingLawsParser instance = new AffectingLawsParser(null, null);

    @Test
    void testLaw2009_400() throws IOException {
        PageSource testPage = getPageSourceObj("/sweden/affecting_laws_2009_400.html");
        testPage.setPageUrl("http://rkrattsbaser.gov.se/sfsr?bet=2009:400");

        Set<String> expected = Set.of("2009:527", "2009:550", "2009:612", "2009:613", "2009:676", "2009:677", "2009:707", "2009:871", "2009:1017", "2009:1020", "2009:1270", "2009:1293", "2009:1419", "2010:30", "2010:85", "2010:88", "2010:208", "2010:214", "2010:368", "2010:369", "2010:372", "2010:383", "2010:456", "2010:498", "2010:520", "2010:573", "2010:628", "2010:679", "2010:715", "2010:866", "2010:1048", "2010:1305", "2010:1343", "2010:1348", "2010:1361", "2010:1436", "2010:1507", "2010:1540", "2010:1633", "2010:1768", "2010:1883", "2010:1890", "2010:1982", "2010:2076", "2011:191", "2011:494", "2011:553", "2011:606", "2011:727", "2011:739", "2011:743", "2011:744", "2011:774", "2011:779", "2011:864", "2011:1036", "2011:1113", "2011:1202", "2011:1217", "2011:1427", "2011:1544", "2011:1574", "2012:147", "2012:235", "2012:288", "2012:311", "2012:324", "2012:450", "2012:459", "2012:630", "2012:664", "2012:689", "2012:736", "2012:765", "2012:770", "2012:778", "2012:804", "2012:828", "2012:846", "2012:850", "2012:920", "2012:956", "2013:133", "2013:275", "2013:289", "2013:314", "2013:339", "2013:406", "2013:461", "2013:626", "2013:765", "2013:795", "2013:878", "2013:972", "2013:1028", "2013:1139", "2013:1148", "2014:29", "2014:57", "2014:259", "2014:277", "2014:296", "2014:304", "2014:329", "2014:344", "2014:357", "2014:361", "2014:403", "2014:415", "2014:492", "2014:633", "2014:806", "2014:830", "2014:851", "2014:887", "2014:897", "2014:987", "2014:1563", "2015:53", "2015:66", "2015:196", "2015:268", "2015:283", "2015:434", "2015:438", "2015:603", "2015:645", "2015:781", "2015:917", "2015:973", "2015:1033", "2016:62", "2016:149", "2016:418", "2016:441", "2016:501", "2016:528", "2016:628", "2016:688", "2016:703", "2016:728", "2016:750", "2016:758", "2016:883", "2016:1008", "2016:1030", "2016:1155", "2016:1203", "2016:1297", "2016:1314", "2017:178", "2017:184", "2017:314", "2017:318", "2017:351", "2017:377", "2017:456", "2017:499", "2017:594", "2017:600", "2017:614", "2017:651", "2017:697", "2017:1012", "2017:1076", "2017:1077", "2017:1133", "2017:1135", "2017:1246", "2017:1313", "2018:84", "2018:93", "2018:140", "2018:163", "2018:220", "2018:498", "2018:561", "2018:591", "2018:603", "2018:682", "2018:691", "2018:1093", "2018:1114", "2018:1116", "2018:1144", "2018:1157", "2018:1185", "2018:1194", "2018:1201", "2018:1216", "2018:1228", "2018:1245", "2018:1269", "2018:1276", "2018:1372", "2018:1377", "2018:1400", "2018:1626", "2018:1708", "2018:1716", "2018:1919", "2018:1936", "2018:1968", "2018:2000", "2018:2027", "2018:2033", "2018:2059", "2018:2060", "2018:2093", "2019:213", "2019:249", "2019:280", "2019:305", "2019:311", "2019:342", "2019:421", "2019:434", "2019:506", "2019:607", "2019:730", "2019:763", "2019:826", "2019:937", "2019:993", "2019:1184", "2019:1207", "2020:66", "2020:109", "2020:143", "2020:182", "2020:277", "2020:309", "2020:327", "2020:436", "2020:452", "2020:560", "2020:569", "2020:575", "2020:602", "2020:606", "2020:620", "2020:773", "2020:908", "2020:961", "2020:1036", "2020:1064", "2020:1112", "2020:1179", "2020:1276", "2021:37", "2021:46", "2021:82", "2021:442", "2021:443", "2021:533", "2021:544", "2021:580", "2021:615", "2021:616", "2021:617", "2021:618", "2021:644", "2021:646", "2021:672", "2021:673", "2021:891", "2021:898", "2021:918", "2021:921", "2021:1071", "2021:1101", "2021:1120", "2021:1128", "2021:1184", "2021:1190", "2022:142", "2022:143", "2022:251", "2022:325", "2022:377", "2022:408", "2022:496", "2022:583", "2022:610", "2022:614", "2022:619", "2022:678", "2022:744", "2022:763", "2022:793", "2022:874", "2022:916", "2022:957", "2022:993", "2022:1013", "2022:1242", "2022:1297", "2022:1314", "2022:1495", "2022:1535", "2022:1538", "2022:1579", "2022:1655", "2022:1685", "2022:1758", "2023:20", "2023:41", "2023:54", "2023:88", "2023:106", "2023:162", "2023:189", "2023:217", "2023:284", "2023:298", "2023:299", "2023:321", "2023:335", "2023:353", "2023:357", "2023:373", "2023:445", "2023:460");

        Set<String> result = instance.parseLawReferences(Jsoup.parse(testPage.getRawSource()));

        assertEquals(expected.size(), result.size());
        assertEquals(expected, result);
    }

}
